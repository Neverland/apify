!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("deep-assign"),require("whatwg-fetch"),require("detect-node"),require("node-fetch"),require("query-string")):"function"==typeof define&&define.amd?define(["underscore","deep-assign","whatwg-fetch","detect-node","node-fetch","query-string"],t):e["i-apify"]=t(e.u,e["deepAssign:"],null,e.isNode,e.nodeFetch,e.queryString)}(this,function(e,t,r,o,n,u){"use strict";function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"POST",r=arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=n,i=u.hook,c=void 0===i?{}:i,l=u.handler,p=void 0===l?{}:l;if(c=f({},g,c),p=f({},x,p),n=t({},h,{handler:p},{hook:c},n),!n.METHOD[e])return Promise.reject(p.error({success:!1,message:"The "+e+" type doesn't support!"},n));if(e=n.METHOD[e],n=f({},n,{"x-uri":r,"x-method":e}),"json"!==n.dataType.toLocaleLowerCase())return Promise.reject(p.error({success:!1,message:"Data type doesn't support!"},n));var v=n.hook,y=T.timeout,m=n[y];v.beforeRequest(n);var P=new Promise(function(t,u){var i=setTimeout(function(){return v.timeout(n),u(p.error({type:!1,message:"network timeout!",data:{}},n,P))},m);if(!a){var c={type:!1,message:"The fetch is not defined!",data:{}},f=p.error(c,n,P);return u(f)}var l=s.getPayload(e,o,n,P);return a(r,l).then(function(e){return s.clearTimeout(i),200!==e.status?u(e):(v.requestSuccess(n,e),e.json())}).then(function(e){var r={success:!1,message:"success",data:e};v.afterParse(n,r);var o=p.success(r,n,P);return d.isPromise(o)?o:t(o||r)}).catch(function(e){var t={},r=e.status,o=void 0===r?{}:r,a=e.statusText,c=void 0===a?"":a,f=e.message,l=void 0===f?"":f;if(s.clearTimeout(i),v.requestFail(n,e),o&&200!==o){var y={success:!1,message:c||l||"Error",data:e};if(t=p.error(y,n,P),d.isPromise(t))return t}if(!o||!l)return u(e)})});return P}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,o=o&&o.hasOwnProperty("default")?o.default:o,n=n&&n.hasOwnProperty("default")?n.default:n,u=u&&u.hasOwnProperty("default")?u.default:u;var i=void 0;i=o?n:window.fetch;var a=i;module.exports=exports.default;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=(function(){function e(e){this.value=e}function t(t){function r(e,t){return new Promise(function(r,n){var i={key:e,arg:t,resolve:r,reject:n,next:null};s?s=s.next=i:(u=s=i,o(e,t))})}function o(r,u){try{var s=t[r](u),i=s.value;i instanceof e?Promise.resolve(i.value).then(function(e){o("next",e)},function(e){o("throw",e)}):n(s.done?"return":"normal",s.value)}catch(e){n("throw",e)}}function n(e,t){switch(e){case"return":u.resolve({value:t,done:!0});break;case"throw":u.reject(t);break;default:u.resolve({value:t,done:!1})}u=u.next,u?o(u.key,u.arg):s=null}var u,s;this._invoke=r,"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}),d={isPromise:function(e){return"[object Promise]"===Object.prototype.toString.call(e)||!!e&&("object"===(void 0===e?"undefined":void 0===e?"undefined":c(e))||"function"==typeof e)&&"function"==typeof e.constructor&&!Object.hasOwnProperty.call(e,"constructor")&&"Promise"===e.constructor.name}};module.exports=exports.default;var l={GET:"GET",POST:"POST",DELETE:"DELETE",PUT:"PUT"},p={silent:"x-silent",message:"x-message",timeout:"x-timeout"},v={credentials:"same-origin"},y={"x-silent":!1,"x-message":!0,"x-timeout":5e3},m={Accept:"application/json","Content-Type":"application/json"},h=f({},{timeout:5e3,headers:m,credentials:v,dataType:"json",X_OPTION_ENUM:p,METHOD:l},y);module.exports=exports.default;var x={success:function(e,t,r){return e},error:function(e,t,r){return e},payload:function(e,t,r){return e}};module.exports=exports.default;var g={beforeRequest:function(){},timeout:function(){},requestSuccess:function(){},afterParse:function(){},requestFail:function(){}};module.exports=exports.default;var P=["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity"];module.exports=exports.default;var T=h.X_OPTION_ENUM;s.getPayload=function(t,r,o,n){var u=o.credentials,s=o.headers;"string"!=typeof r&&(r=JSON.stringify(r));var i=e.pick(o,P);return r=f({},{method:t},{headers:s},{body:r},u,i),"GET"===t&&delete r.body,x.payload(r,o,n)||r},s.clearTimeout=function(e){return clearTimeout(e)},module.exports=exports.default;var b=function(e,t,r){return s("POST",e,t,r)};module.exports=exports.default;var O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],o={},n=e;if(e.indexOf("?")>-1){var i=e.split("?");n=i[0],o=u.parse(i[1])}var a=f({},o,t),c=u.stringify(a);return c&&(e=n+"?"+c),s("GET",e,"",r)};module.exports=exports.default;var w={get:O,post:b};module.exports=exports.default;var S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=f({},t),Object.keys(t||{}).forEach(function(o){var n=f(t[o]);t[o]=function(t,o){var u=f({},t);return e(n,u,f({},r,o))},t[o].origin||(t[o].origin=n),t[o].getUrl=function(){return n.toString()}}),t||{}};module.exports=exports.default;var j={request:w,apify:S};return module.exports=exports.default,j});
//# sourceMappingURL=index.min.js.map