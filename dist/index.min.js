!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("deep-assign"),require("detect-node"),require("query-string")):"function"==typeof define&&define.amd?define(["underscore","deep-assign","detect-node","query-string"],t):e["i-apify"]=t(e.u,e["deepAssign:"],e.isNode,e.queryString)}(this,function(e,t,r,o){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"POST",r=arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=u,d=s.hook,c=void 0===d?{}:d,l=s.handler,p=void 0===l?{}:l;if(c=a({},h,c),p=a({},v,p),u=t({},y,{handler:p},{hook:c},u),!u.METHOD[e])return Promise.reject(p.error({success:!1,message:"The "+e+" type doesn't support!"}));if(e=u.METHOD[e],u=a({},u,{"x-uri":r,"x-method":e}),"json"!==u.dataType.toLocaleLowerCase())return Promise.reject(p.error({success:!1,message:"Data type doesn't support!"}));var m=u.hook,g=(x.silent,x.message,x.timeout),P=u[g];m.beforeRequest(u);var w=n.getPayload(e,o,u),T=new Promise(function(e,t){var o=setTimeout(function(){return m.timeout(u),t(p.error({type:!1,message:"network timeout!",data:{}},T))},P);return i(function(e){if(!e){var o={type:!1,message:"The fetch is not defined!",data:{}},n=p.error(o,T);return t(n)}return e(r,w)}).then(function(e){return 200!==e.status?(n.clearTimeout(o),t(e)):(m.requestSuccess(u,e),e.json())}).then(function(t){var r={success:!1,message:"success",data:t},o=p.success(r,u,T);return f.isPromise(o)?o:e(o||r)}).catch(function(e){var r={},i=e.status,s=void 0===i?{}:i,a=e.statusText,d=void 0===a?"Error":a;if(n.clearTimeout(o),m.requestFail(u,e),s&&200!==s){var c={success:!1,message:d,data:e};if(r=p.error(c,u,T),f.isPromise(r))return r}return t(r)})});return T}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,o=o&&o.hasOwnProperty("default")?o.default:o;var u="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{},i=function(){return Promise.resolve().then(function(){return r?("function"==typeof u.define&&u.define.amd?new Promise(function(e,t){u.require(["node-fetch"],e,t)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&u.require&&"component"===u.require.loader?Promise.resolve(require("node-fetch")):Promise.resolve(u["node-fetch"])).then:("function"==typeof u.define&&u.define.amd?new Promise(function(e,t){u.require(["whatwg-fetch"],e,t)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&u.require&&"component"===u.require.loader?Promise.resolve(require("whatwg-fetch")):Promise.resolve(u["whatwg-fetch"])).then})};module.exports=exports.default;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=(function(){function e(e){this.value=e}function t(t){function r(e,t){return new Promise(function(r,n){var s={key:e,arg:t,resolve:r,reject:n,next:null};i?i=i.next=s:(u=i=s,o(e,t))})}function o(r,u){try{var i=t[r](u),s=i.value;s instanceof e?Promise.resolve(s.value).then(function(e){o("next",e)},function(e){o("throw",e)}):n(i.done?"return":"normal",i.value)}catch(e){n("throw",e)}}function n(e,t){switch(e){case"return":u.resolve({value:t,done:!0});break;case"throw":u.reject(t);break;default:u.resolve({value:t,done:!1})}u=u.next,u?o(u.key,u.arg):i=null}var u,i;this._invoke=r,"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}),f={isPromise:function(e){return"[object Promise]"===Object.prototype.toString.call(e)||!!e&&("object"===(void 0===e?"undefined":void 0===e?"undefined":s(e))||"function"==typeof e)&&"function"==typeof e.constructor&&!Object.hasOwnProperty.call(e,"constructor")&&"Promise"===e.constructor.name}};module.exports=exports.default;var d={GET:"GET",POST:"POST",DELETE:"DELETE",PUT:"PUT"},c={silent:"x-silent",message:"x-message",timeout:"x-timeout"},l={credentials:"same-origin"},p={"x-silent":!1,"x-message":!0,"x-timeout":5e3},m={Accept:"application/json","Content-Type":"application/json"},y=a({},{timeout:5e3,headers:m,credentials:l,dataType:"json",X_OPTION_ENUM:c,METHOD:d},p);module.exports=exports.default;var v={success:function(e,t){return e},error:function(e,t){return e}};module.exports=exports.default;var h={beforeRequest:function(){},payload:function(e){return e},timeout:function(){},requestSuccess:function(){},requestFail:function(){}};module.exports=exports.default;var g=["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity"];module.exports=exports.default;var x=y.X_OPTION_ENUM;n.getPayload=function(t,r,o){var n=o.credentials,u=o.headers,i=o.hook;"string"!=typeof r&&(r=JSON.stringify(r));var s=e.pick(o,g);return r=a({},{method:t},{headers:u},{body:r},n,s),"GET"===t&&delete r.body,i.payload(o,r)},n.clearTimeout=function(e){clearTimeout(e)},module.exports=exports.default;var P=function(e,t,r){return n("POST",e,t,r)};module.exports=exports.default;var w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],u={},i=e;if(e.indexOf("?")>-1){var s=e.split("?");i=s[0],u=o.parse(s[1])}var f=a({},u,t),d=o.stringify(f);return d&&(e=i+"?"+d),n("GET",e,"",r)};module.exports=exports.default;var T={get:w,post:P};module.exports=exports.default;var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=a({},t),Object.keys(t||{}).forEach(function(o){var n=a(t[o]);t[o]=function(t,o){var u=a({},t);return e(n,u,a({},r,o))},t[o].origin||(t[o].origin=n),t[o].getUrl=function(){return n.toString()}}),t||{}};module.exports=exports.default;var q={request:T,apify:b};return module.exports=exports.default,q});
//# sourceMappingURL=index.min.js.map