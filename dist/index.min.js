!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("query-string"),require("deep-assign")):"function"==typeof define&&define.amd?define(["underscore","query-string","deep-assign"],t):e["i-apify"]=t(e.u,e.queryString,e.deepAssign)}(this,function(e,t,r){"use strict";function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"POST",t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=s,c=a.hook,f=void 0===c?{}:c,l=a.handler,m=void 0===l?{}:l;if(f=u({},y,f),m=u({},p,m),s=r({},d,{handler:m},{hook:f},s),"json"!==s.dataType.toLocaleLowerCase())return Promise.reject(m.error({success:!1,message:"Data type doesn't support!"}));var h=s.hook,g=(v.silent,v.message,v.timeout),x=s[g];h.beforeRequest(s);var b=o.getPayload(e,n,s),P=new Promise(function(e,r){var o=setTimeout(function(){return h.timeout(),r(m.error({type:!1,message:"network timeout!",data:{}},P))},x);return fetch(t,b).then(function(t){return 200!==t.status?(clearTimeout(o),r(t)):(h.requestSuccess(),t.json().then(function(t){var r={success:!1,message:"success",data:t},o=m.success(r,P);return i.isPromise(o)?o:e(o||r)}))}).catch(function(e){var t={},o=e.status,n=void 0===o?{}:o,u=e.statusText,s=void 0===u?"Error":u;if(h.requestFail(),n&&200!==n){var a={success:!1,message:s,data:e};if(t=m.error(a,P),i.isPromise(t))return t}return r(t)})});return P}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=(function(){function e(e){this.value=e}function t(t){function r(e,t){return new Promise(function(r,n){var s={key:e,arg:t,resolve:r,reject:n,next:null};i?i=i.next=s:(u=i=s,o(e,t))})}function o(r,u){try{var i=t[r](u),s=i.value;s instanceof e?Promise.resolve(s.value).then(function(e){o("next",e)},function(e){o("throw",e)}):n(i.done?"return":"normal",i.value)}catch(e){n("throw",e)}}function n(e,t){switch(e){case"return":u.resolve({value:t,done:!0});break;case"throw":u.reject(t);break;default:u.resolve({value:t,done:!1})}u=u.next,u?o(u.key,u.arg):i=null}var u,i;this._invoke=r,"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}),i={isPromise:function(e){return"[object Promise]"===Object.prototype.toString.call(e)||!!e&&("object"===(void 0===e?"undefined":void 0===e?"undefined":n(e))||"function"==typeof e)&&"function"==typeof e.constructor&&!Object.hasOwnProperty.call(e,"constructor")&&"Promise"===e.constructor.name}};module.exports=exports.default;var s={GET:"GET",POST:"POST",DELETE:"DELETE",PUT:"PUT"},a={silent:"x-silent",message:"x-message",timeout:"x-timeout"},c={credentials:"same-origin"},f={"x-silent":!1,"x-message":!0,"x-timeout":5e3},l={Accept:"application/json","Content-Type":"application/json"},d=u({},{timeout:5e3,headers:l,credentials:c,dataType:"json",X_OPTION_ENUM:a,METHOD:s},f);module.exports=exports.default;var p={success:function(e,t){return e},error:function(e,t){return e}};module.exports=exports.default;var y={beforeRequest:function(){},payload:function(e){return e},timeout:function(){},requestSuccess:function(){},requestFail:function(){}};module.exports=exports.default;var m=["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity"];module.exports=exports.default;var v=d.X_OPTION_ENUM,h=d.METHOD;o.getPayload=function(t,r,o){var n=o.credentials,i=o.headers,s=o.hook;"string"!=typeof r&&(r=JSON.stringify(r));var a=e.pick(o,m);return r=u({},{method:t},{headers:i},{body:r},n,a),s.payload(r)};var g={};g.post=function(e,t,r){return o(h.POST,e,t,r)},g.get=function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2];e.isObject(o)&&!e.isEmpty(o)&&(o=t.stringify(o)),0!==o.length&&-1===r.indexOf("?")&&(r+="?"),r+=o;var i=u({},{method:h.GET},n);return fetch(r,{param:i})},module.exports=exports.default;var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=u({},t),Object.keys(t||{}).forEach(function(o){var n=u(t[o]);t[o]=function(t,o){var i=u({},t);return e(n,i,u({},r,o))},t[o].origin||(t[o].origin=n),t[o].getUrl=function(){return n.toString()}}),t||{}};module.exports=exports.default;var b={request:g,apify:x};return module.exports=exports.default,b});
//# sourceMappingURL=index.min.js.map