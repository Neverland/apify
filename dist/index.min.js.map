{"version":3,"file":"index.min.js","sources":["../src/util.js","../src/constants.js","../src/config/handler.js","../src/config/hook.js","../src/config/fetchOptionList.js","../src/request.js","../src/method/post.js","../src/method/get.js","../src/method/index.js","../src/apify.js","../src/index.js"],"sourcesContent":["/**\n * @file util\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/6\n */\n\nexport default {\n    isPromise(obj) {\n        return Object.prototype.toString.call(obj) === '[object Promise]' || !!obj && ((typeof obj === 'undefined' ? 'undefined' : typeof(obj)) === 'object' || typeof obj === 'function') && typeof obj.constructor === 'function' && !Object.hasOwnProperty.call(obj, 'constructor') && obj.constructor.name === 'Promise';\n    }\n}\n","/**\n * @file constants\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/5\n */\n\nconst GET = 'GET';\nconst POST = 'POST';\nconst DELETE = 'DELETE';\nconst PUT = 'PUT';\n\nconst METHOD = {\n    GET,\n    POST,\n    DELETE,\n    PUT\n};\n\n/**\n * @const FETCH_TIMEOUT - 5s\n */\nconst FETCH_TIMEOUT = 1000 * 5;\n\nconst X_OPTION_ENUM = {\n    silent: 'x-silent',\n    message: 'x-message',\n    timeout: 'x-timeout'\n};\n\n/**\n * @const same-origin 只有同源有这个配置才能传递cookie\n */\nconst CREDENTIALS = 'omit';\n\nconst X_OPTION = {\n    // 用于控制 ui loading\n    'x-silent': false,\n    // 用于控制 ui dialog 抛出的全局信息\n    'x-message': true,\n    // 用于控制 ui dialog 抛出的全局信息\n    'x-timeout': FETCH_TIMEOUT\n};\n\nconst HEADERS = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n};\n\nconst DATA_TYPE = 'json';\n\nexport default Object.assign({},\n    {\n        timeout: FETCH_TIMEOUT,\n        headers: HEADERS,\n        credentials: CREDENTIALS,\n        dataType: DATA_TYPE,\n        X_OPTION_ENUM,\n        METHOD\n    },\n    X_OPTION\n);\n","/**\n * @file handler\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/5\n */\n\nexport default {\n    success(data) {\n        return data;\n    },\n    error(data) {\n        return data;\n    },\n    payload(data) {\n        return data;\n    }\n};\n","/**\n * @file hook\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/6\n */\n\nexport default {\n    beforeRequest() {\n\n    },\n    timeout() {\n\n    },\n    requestSuccess() {\n\n    },\n    afterParse() {\n\n    },\n    requestFail() {\n\n    }\n}\n","/**\n * @file fetchOption\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/6\n */\n\nexport default [\n    'method',        // GET/POST等\n    'headers',       // 一个普通对象，或者一个 Headers 对象\n    'body',          // 传递给服务器的数据，可以是字符串/Buffer/Blob/FormData，如果方法是 GET/HEAD，则不能有此参数\n    'mode',          // cors / no-cors / same-origin， 是否跨域，默认是 no-cors\n    'credentials',   // omit / same-origin / include\n    'cache',         // default / no-store / reload / no-cache / force-cache / only-if-cached\n    'redirect',      // follow / error / manual\n    'referrer',      // no-referrer / client / 或者一个url\n    'referrerPolicy',// no-referrer / no-referrer-when-downgrade / origin /  origin-when-cross-origin / unsafe-url\n    'integrity'      // 资源完整性验证\n]\n","/**\n * @file request\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/5\n */\n\n/* global Promise */\n\nimport './fetch';\n\nimport u from 'underscore';\nimport deepAssign from 'deep-assign';\n\nimport util from './util';\n\nimport defaultConfig from './constants';\nimport handlers from './config/handler';\nimport hooks from './config/hook';\nimport fetchOptionList from './config/fetchOptionList';\n\nlet {X_OPTION_ENUM, METHOD} = defaultConfig;\n\n/**\n * sendRequest\n *\n * option 中的配置可以覆盖默认配置\n * 如x-silent配置为true那么就不启用loading\n *\n * @param {string} method - POST|GET|PUT|DELETE\n * @param {string} uri - uri\n * @param {?Object} data - payload\n * @param {Object} option - custom option\n * @return {Promise}\n */\n\nfunction sendRequest(method = 'POST', uri, data = {}, option = {}) {\n    let {hook = {}, handler = {}} = option;\n\n    hook = Object.assign({}, hooks, hook);\n    handler = Object.assign({}, handlers, handler);\n    option = deepAssign({}, defaultConfig, {handler}, {hook}, option);\n\n    if (!option.METHOD[method]) {\n        return Promise.reject(handler.error({success: false, message: `The ${method} type doesn\\'t support!`}, option));\n    }\n\n    method = option.METHOD[method];\n    option = Object.assign({}, option, {\n        'x-uri': uri,\n        'x-method': method\n    });\n\n    if ('json' !== option.dataType.toLocaleLowerCase()) {\n        return Promise.reject(handler.error({success: false, message: 'Data type doesn\\'t support!'}, option));\n    }\n\n    let globalHook = option.hook;\n\n    /**\n     * 从枚举获取真实key\n     *\n     * 'x-silent',\n     * 'x-message',\n     * 'x-timeout'\n     *\n     */\n    let {timeout} = X_OPTION_ENUM;\n    let xTimeout = option[timeout];\n\n    /**\n     * hook: beforeRequest\n     */\n    globalHook.beforeRequest(option);\n\n    return new Promise((resolve, reject) => {\n        let networkTimeout = setTimeout(() => {\n            /**\n             * hook: timeout\n             */\n            globalHook.timeout(option);\n\n            return reject(handler.error({type: false, message: 'network timeout!', data: {}}, option));\n        }, xTimeout);\n\n        if (!fetch) {\n            let data = {type: false, message: 'The fetch is not defined!', data: {}};\n            /**\n             * handler: error()\n             */\n            let result = handler.error(data, option);\n\n            return reject(result);\n        }\n\n        let payload = sendRequest.getPayload(method, data, option);\n\n        return fetch(option['x-uri'], payload)\n            .then(response => {\n                sendRequest.clearTimeout(networkTimeout);\n\n                if (response.status !== 200) {\n                    return Promise.reject(response);\n                }\n                /**\n                 * hook: requestSuccess()\n                 */\n                globalHook.requestSuccess(option, response);\n\n                return response.json();\n            })\n            .then(json => {\n                let data = {success: true, message: 'success', data: json};\n\n                /**\n                 * hook: afterParse()\n                 */\n                globalHook.afterParse(option, data);\n\n                /**\n                 * handler: success()\n                 */\n                let result = handler.success(data, option);\n\n                if (util.isPromise(result)) {\n                    return result;\n                }\n\n                return resolve(result || data);\n            })\n            .catch(error => {\n                let result = {};\n                let {status = {}, statusText = '', message = ''} = error;\n\n                sendRequest.clearTimeout(networkTimeout);\n\n                /**\n                 * hook: requestFail()\n                 */\n                globalHook.requestFail(option, error);\n\n                // 404, 500 ...\n                if (status && status !== 200) {\n                    let data = {success: false, message: statusText || message || 'Error', data: error};\n\n                    /**\n                     * handler: error()\n                     */\n                    result = handler.error(data, option);\n\n                    if (util.isPromise(result)) {\n                        return result;\n                    }\n                }\n\n                return reject(error);\n            });\n    });\n}\n\n/**\n * 获取最终payload\n *\n * @param {string} method - http method\n * @param {string} data - 配置加数据产生的fetch option\n * @param {Promise} promise - fetch 实例\n */\nsendRequest.getPayload = (method, data, option) => {\n    let {credentials, headers} = option;\n\n    if ('string' !== typeof data) {\n        data = JSON.stringify(data, (key, value) => {\n            if (undefined === value) {\n                return null;\n            }\n\n            return value;\n        });\n    }\n\n    let fetchOption = u.pick(option, fetchOptionList);\n\n    data = Object.assign(\n        {},\n        {method},\n        {headers},\n        {body: data},\n        {credentials},\n        fetchOption\n    );\n\n    if ('GET' === method) {\n        delete data.body;\n    }\n\n    /**\n     * handler: payload()\n     */\n    return option.handler.payload(data, option) || data;\n};\n\nsendRequest.clearTimeout = timeout => clearTimeout(timeout);\n\nexport default sendRequest;\n\n","/**\n * @file post\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/25\n */\n\nimport request from '../request';\n\n/**\n * post\n *\n * @param {string} uri\n * @param {?Object} data - 提交的数据\n * @param {?Object} option - 可以覆盖 fetch api的配置\n * @return {Promise}\n */\n\nexport default (uri, data, option) => request('POST', uri, data, option);\n","/**\n * @file get\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/25\n */\n\n/* global queryString */\n\nimport queryString from 'query-string';\n\nimport request from '../request';\n\n/**\n * get\n *\n * @param {string} uri\n * @param {string} data -  fromData\n * @param {?Object} option - 可以覆盖 fetch api的配置\n * @return {Promise}\n */\n\nexport default (uri, data = {}, option) => {\n    /**\n     * @property {Object} search - 用于收集uri上的search\n     */\n    let search = {};\n    /**\n     * @property {string} pureUri - 用于存储除search外的根链接\n     */\n    let pureUri = uri;\n    /**\n     * @property {string} hasSearch - 用于标示uri中是否有`search`\n     */\n    let hasSearch = uri.indexOf('?') > -1;\n\n    if (hasSearch) {\n        let temp = uri.split('?');\n\n        pureUri = temp[0];\n        search = queryString.parse(temp[1]);\n    }\n\n    let payload = Object.assign({}, search, data);\n    let query = queryString.stringify(payload);\n\n    if (query) {\n        uri = `${pureUri}?${query}`;\n    }\n\n    return request('GET', uri, '', option);\n};\n","/**\n * @file index\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/25\n */\n\nimport post from './post';\nimport get from './get';\n\nexport default {\n    get,\n    post\n}\n","/**\n * @file apify\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/6\n */\n\n/**\n * 使api url function 化\n *\n * e.g\n *\n *  const API_CONFIG = {\n *      postCode: '/api/post/code',\n *      postAuth: '/api/post/auth'\n *  }\n *\n *  api = apify(API_CONFIG);\n *\n *  api.postCode({})\n *      .then()\n *      .fail();\n */\n\n/**\n * apify\n *\n * @param {Function} sendRequest 发送请求的函数\n * @param {Object} apis - 静态uri映射map\n * @param {Object} configure - 可以覆盖 fetch api的配置\n * @return {Object}\n */\nexport default\nfunction (sendRequest, apis = {}, configure = {}) {\n    apis = Object.assign({}, apis);\n\n    let all = Object.keys(apis || {});\n\n    all.forEach(key => {\n        let origin = Object.assign(apis[key]);\n\n        apis[key] = (options, config) => {\n            let param = Object.assign({}, options);\n\n            return sendRequest(origin, param, Object.assign({}, configure, config));\n        };\n\n        apis[key].origin || (apis[key].origin = origin);\n\n        apis[key].getUrl = () => origin.toString();\n    });\n\n    return apis || {};\n}\n\n","/**\n * @file index\n * @author ienix(enix@foxmail.com)\n *\n * @since 2017/9/6\n */\n\nimport request from './method/index';\nimport apify from './apify';\n\nexport default {\n    request,\n    apify\n}\n"],"names":["isPromise","obj","Object","prototype","toString","call","constructor","hasOwnProperty","name","GET","POST","DELETE","PUT","METHOD","FETCH_TIMEOUT","X_OPTION_ENUM","silent","message","timeout","CREDENTIALS","X_OPTION","HEADERS","DATA_TYPE","assign","headers","credentials","dataType","success","data","error","payload","beforeRequest","requestSuccess","afterParse","requestFail","defaultConfig","sendRequest","method","uri","option","hook","handler","hooks","handlers","deepAssign","Promise","reject","toLocaleLowerCase","globalHook","xTimeout","resolve","networkTimeout","setTimeout","type","fetch","result","getPayload","then","response","clearTimeout","status","json","util","statusText","JSON","stringify","key","value","undefined","fetchOption","u","pick","fetchOptionList","body","request","search","pureUri","hasSearch","indexOf","temp","split","queryString","parse","query","get","post","apis","configure","all","keys","forEach","origin","options","config","param","getUrl","apify"],"mappings":"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"}